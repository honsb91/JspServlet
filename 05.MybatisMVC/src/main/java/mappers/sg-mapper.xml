<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sg">

	<select id="select" resultType="sg.SgVO">
		SELECT EMPLOYEE_ID, FIRST_NAME || ' ' || LAST_NAME name,TO_CHAR( HIRE_DATE ,'yyyy-mm-dd' ) hire_date,DEPARTMENT_NAME
		FROM EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
		
		<!-- 쿼리 디버깅시 주석처리가 용이 -->
		<!-- 동적쿼리에서 특정상황마다 WHERE절을 다르게 작성해줘야 할때 편리 -->
		<!-- 동적쿼리란 조건에 따라서 결과값이 달라지는 쿼리 -->
		<!-- SQL문에도 와일드 카드가 있음 
			 '_' 와 '%' 
			 '_' -> 하나의 캐릭터 ( 문자 )
			 '%' -> 하나의 스트링 ( 문자열 )
		-->
		WHERE 1=1 
		<if test="option !=null">
			<choose>
				<when test="option == 'all'">
					AND UPPER (E.FIRST_NAME || E.LAST_NAME) LIKE '%' || UPPER(#{keyword}) || '%'
        				OR UPPER (D.DEPARTMENT_NAME) LIKE '%' || UPPER(#{keyword}) || '%'
				</when>
				<when test="option == 'name'">
        				AND UPPER (E.FIRST_NAME || E.LAST_NAME) LIKE '%' || UPPER(#{keyword}) || '%'
        			</when>
        			<otherwise>
        				AND UPPER(${option}) LIKE '%' || UPPER(#{keyword}) || '%'
        			</otherwise>
			</choose>
		</if>
	</select>
	
	<insert id="insert">
		INSERT INTO EMPLOYEES 
	
	</insert>

</mapper>